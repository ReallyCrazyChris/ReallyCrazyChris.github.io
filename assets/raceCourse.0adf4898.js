import{d as n}from"./index.42812f5f.js";import{b as d}from"./extent.d7cb0bc8.js";import{u as p}from"./mqtt-vue-hook.es.c8aea688.js";const h={name:"W",description:"Windward"},g=[{type:"label",text:"Windward",offset:[-50,450],color:"black",size:30,locked:!0},{type:"buoy",text:"1",offset:[-50,350],color:"yellow",radius:10,locked:!1},{type:"gate",color:"orange",text:"START",left:{text:"2p",offset:[-100,0],color:"orange",radius:10,locked:!1},right:{text:"2s",offset:[0,0],color:"orange",radius:10,locked:!0}},{type:"line",color:"black",text:"",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"leeward",left:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"left",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"black",text:"right",left:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"lapinfo",color:"black",size:24,left:{offset:[-220,400]},right:{offset:[-220,-150]}}],y=[{lapCount:1,label:"L1",description:"START \u21A6 1 \u21A6 2p + FINISH"},{lapCount:2,label:"L2",description:"START \u21A6 1 \u21A6 2p \u21A6 1 \u21A6 2p + FINISH"},{lapCount:3,label:"L3",description:"START \u21A6 1 \u21A6 2 \u21A6 1 \u21A6 2p \u21A6 1 \u21A6 2p  + FINISH"}],x={name:"WL",description:"Windward + Leeward"},A=[{type:"label",text:"Windward + Leeward",offset:[-50,450],color:"black",size:30,locked:!0},{type:"buoy",text:"1",offset:[-50,350],color:"yellow",radius:10,locked:!1},{type:"buoy",text:"2",offset:[-50,-100],color:"yellow",radius:10,locked:!1},{type:"gate",color:"grey",text:"START / FINISH",left:{text:"",offset:[-100,0],color:"orange",radius:10,locked:!1},right:{text:"",offset:[0,0],color:"orange",radius:10,locked:!0}},{type:"line",color:"black",text:"",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"leeward",left:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"left",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"black",text:"right",left:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"lapinfo",color:"black",size:24,left:{offset:[-220,400]},right:{offset:[-220,-150]}}],k=[{lapCount:1,label:"WL1",description:"START \u21A6 1 \u21A6 2 \u21A6 FINISH"},{lapCount:2,label:"WL2",description:"START \u21A6 1 \u21A6 2 \u21A6 1 \u21A6 2 \u21A6 FINISH"},{lapCount:3,label:"WL3",description:"START \u21A6 1 \u21A6 2 \u21A6 1 \u21A6 2 \u21A6 1 \u21A6 2 \u21A6 FINISH"}],R={name:"WLR29ER",description:"29er Leeward"},T=[{type:"label",text:"29er Leeward",offset:[-50,450],color:"black",size:30,locked:!0},{type:"buoy",text:"1",offset:[-50,350],color:"yellow",radius:10,locked:!1},{type:"gate",color:"yellow",text:"gate",left:{text:"2s",offset:[-100,100],color:"yellow",radius:10,locked:!1},right:{text:"2p",offset:[0,100],color:"yellow",radius:10,locked:!1}},{type:"gate",color:"orange",text:"START",left:{text:"",offset:[-100,0],color:"orange",radius:10,locked:!1},right:{text:"",offset:[0,0],color:"orange",radius:10,locked:!0}},{type:"gate",color:"blue",text:"FINISH",left:{text:"",offset:[72,72],color:"blue",radius:10,locked:!1},right:{text:"",offset:[0,0],color:"lightgrey",radius:10,locked:!0}},{type:"line",color:"black",text:"",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"leeward",left:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"left",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"black",text:"right",left:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"lapinfo",color:"black",size:24,left:{offset:[-220,400]},right:{offset:[-220,-150]}}],b=[{lapCount:1,label:"L1",description:"START \u21A6 1 \u21A6 2p \u21A6 FINISH"},{lapCount:2,label:"L2",description:"START \u21A6 1 \u21A6 (2s/2p) \u21A6 1 \u21A6 2p \u21A6 FINISH"},{lapCount:3,label:"L3",description:"START \u21A6 1 \u21A6 (2s/2p) \u21A6 1 \u21A6 (2s/2p) \u21A6 1 \u21A6 2p \u21A6 FINISH"}],S={name:"WLR49ER",description:"49er Windward / Leeward"},L=[{type:"label",text:"49er Windward / Leeward",offset:[-50,450],color:"black",size:30,locked:!0},{type:"buoy",text:"1",offset:[-50,350],color:"yellow",radius:10,locked:!1},{type:"gate",color:"yellow",text:"gate",left:{text:"2s",offset:[-100,-100],color:"yellow",radius:10,locked:!1},right:{text:"2p",offset:[0,-100],color:"yellow",radius:10,locked:!1}},{type:"gate",color:"orange",text:"START",left:{text:"",offset:[-100,0],color:"orange",radius:10,locked:!1},right:{text:"",offset:[0,0],color:"orange",radius:10,locked:!0}},{type:"gate",color:"blue",text:"FINISH",left:{text:"",offset:[-100,-20],color:"blue",radius:10,locked:!1},right:{text:"",offset:[0,-20],color:"blue",radius:10,locked:!0}},{type:"line",color:"black",text:"",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"leeward",left:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"grey",text:"left",left:{text:"",offset:[-200,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[-200,-150],color:"grey",radius:0,locked:!0}},{type:"line",color:"black",text:"right",left:{text:"",offset:[100,400],color:"grey",radius:0,locked:!0},right:{text:"",offset:[100,-150],color:"grey",radius:0,locked:!0}},{type:"lapinfo",color:"black",size:24,left:{offset:[-220,400]},right:{offset:[-220,-150]}}],w=[{lapCount:1,label:"L1",description:"START \u21A6 1 \u21A6 2s/2p \u21A6 FINISH"},{lapCount:2,label:"L2",description:"START \u21A6 1 \u21A6 2s/2p \u21A6 1 \u21A6 2s/2p \u21A6 FINISH"},{lapCount:3,label:"L3",description:"START \u21A6 1 \u21A6 2s/2p\u21A6 1 \u21A6 2s/2p\u21A6 1 \u21A6 2s/2p \u21A6 FINISH"}],I=n("courseRegistary",{state:()=>({meta:[h,x,R,S],features:[g,A,T,L],laps:[y,k,b,w]})}),u=p(),a=I(),m=n("racecourse",{state:()=>({centerOfRotation:[1217300,6295726],rotation:0,scale:[1,1],signature:Date.now(),pointResolution:1,boundry:[[150,500],[-250,500],[150,-250],[-250,-250]],anchorHandle:{color:"orange"},rotateHandle:{offset:[-50,420],color:"aqua"},scaleXHandle:{offset:[-200,400],color:"fuchsia"},scaleYHandle:{offset:[100,400],color:"lime"},selectedLap:0,selectedCourse:0}),getters:{courseTypes(){return a.meta},courseType({selectedCourse:t}){return a.meta[t]},features({selectedCourse:t}){return a.features[t]},lapTypes({selectedCourse:t}){return a.laps[t]},lap({selectedCourse:t,selectedLap:e}){return a.laps[t][e]}},actions:{selectCourseType(t){this.selectedCourse=this.courseTypes.indexOf(t),this.signature=Date.now(),this.publishRaceCourseState()},selectLapType(t){this.selectedLap=this.lapTypes.indexOf(t),this.signature=Date.now(),this.publishRaceCourseState()},publishRaceCourseState(){if(u.isConnected){const t=JSON.stringify({centerOfRotation:this.centerOfRotation,rotation:this.rotation,scale:this.scale,selectedLap:this.selectedLap,selectedCourse:this.selectedCourse,signature:Date.now()});u.publish("racecourse",t,0,{retain:!0})}},rotate(t,e,o){const r=Math.cos(e),s=Math.sin(e),l=o[0],i=o[1],c=t[0]-l,f=t[1]-i;return[l+c*r-f*s,i+c*s+f*r]},forwardTransform(t){return this.rotate([this.centerOfRotation[0]+t[0]*this.scale[0]/this.pointResolution,this.centerOfRotation[1]+t[1]*this.scale[1]/this.pointResolution],this.rotation,this.centerOfRotation)},reverseTransform(t){const e=this.rotate(t,-1*this.rotation,this.centerOfRotation);return[(e[0]-this.centerOfRotation[0])/this.scale[0]*this.pointResolution,(e[1]-this.centerOfRotation[1])/this.scale[1]*this.pointResolution]},setCourseRotation(t){const e=t[0]-this.centerOfRotation[0],o=t[1]-this.centerOfRotation[1],r=Math.atan2(this.rotateHandle.offset[0]/this.pointResolution,this.rotateHandle.offset[1]/this.pointResolution);this.rotation=-1*Math.atan2(e,o)+r},setScaleY(t){const e=this.rotate(t,-1*this.rotation,this.centerOfRotation);e[0]-this.centerOfRotation[0];var o=e[1]-this.centerOfRotation[1];const r=Math.sqrt(o**2)/Math.sqrt(this.scaleYHandle.offset[1]**2)*this.pointResolution;this.scale=[this.scale[0],r]},setScaleX(t){const e=this.rotate(t,-1*this.rotation,this.centerOfRotation);var o=e[0]-this.centerOfRotation[0];e[1]-this.centerOfRotation[1];const r=Math.sqrt(o**2)/Math.sqrt(this.scaleXHandle.offset[0]**2)*this.pointResolution;this.scale=[r,this.scale[1]]},getLineLength(t,e){const o=this.forwardTransform(t.offset),r=this.forwardTransform(e.offset);var s=(o[0]-r[0])*this.pointResolution,l=(o[1]-r[1])*this.pointResolution;return Math.round(Math.sqrt(s**2+l**2))},getTextRotation(t,e){const o=this.forwardTransform(t.offset),r=this.forwardTransform(e.offset);var s=r[0]-o[0],l=r[1]-o[1];return-1*Math.atan2(l,s)},getExtent(){var t=[];return this.boundry.forEach(e=>{t.push(this.forwardTransform(e))}),d(t)}},persist:!1});export{m as u};
